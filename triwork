import subprocess
import re

def get_mongo_identifiers():
    """
    Runs `ps -ef`, extracts config identifiers from mongod process lines,
    and returns unique values found between 'mongo_' and '.conf'.
    """
    result = subprocess.run(
        ["ps", "-ef"], capture_output=True, text=True
    )

    lines = result.stdout.splitlines()
    identifiers = set()

    for line in lines:
        if "mongod" in line and "grep" not in line:
            parts = line.split()
            for token in parts:
                if token.endswith(".conf") and "mongo_" in token:
                    match = re.search(r"mongo_(.+)\.conf", token)
                    if match:
                        identifiers.add(match.group(1))

    return identifiers


if __name__ == "__main__":
    mongo_ids = get_mongo_identifiers()
    print("Unique mongod identifiers found:")
    for mid in sorted(mongo_ids):
        print("-", mid)